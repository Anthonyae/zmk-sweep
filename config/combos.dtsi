compatible = "zmk,combos";
#include "../zmk-nodefree-config/keypos_def/keypos_34keys.h"
#define KEYS_L LT0 LT1 LT2 LT3 LT4 LM0 LM1 LM2 LM3 LM4 LB0 LB1 LB2 LB3 LB4  // left-hand keys
#define KEYS_R RT0 RT1 RT2 RT3 RT4 RM0 RM1 RM2 RM3 RM4 RB0 RB1 RB2 RB3 RB4  // right-hand keys
#define THUMBS LH1 LH0 RH0 RH1  // tHumb keys

#define COMBO_TERM_LOWEST 15
#define COMBO_TERM_LOW 30
#define COMBO_TERM_MEDIUM 40
#define COMBO_TERM_HIGH 50

#undef COMBO_HOOK
#define COMBO_HOOK global-quick-tap-ms = <100>;

/* 5 columns 
0	1	2	3	4		5	6	7	8	9
10	11	12	13	14		15	16	17	18	19
20	21	22	23	24		25	26	27	28	29
		30	31				32	33		
*/

/*                KEY POSITIONS

  ╭─────────────────────╮ ╭─────────────────────╮
  │ LT4 LT3 LT2 LT1 LT0 │ │ RT0 RT1 RT2 RT3 RT4 │
  │ LM4 LM3 LM2 LM1 LM0 │ │ RM0 RM1 RM2 RM3 RM4 │
  │ LB4 LB3 LB2 LB1 LB0 │ │ RB0 RB1 RB2 RB3 RB4 │
  ╰───────╮ LH2 LH1 LH0 │ │ RH0 RH1 RH2 ╭───────╯
          ╰─────────────╯ ╰─────────────╯ */


// layers
// What layer am I on?
// Device settings
// Tricks
// modifiers
// symbols
// keys

// layers

switch_base_layer {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <LT4 LT3 LT2 LT1>;
    bindings = <&to DEFAULT_HM>;
    layers = <0 1 2 3>;
};

switch_hm_one_layer {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <LB4 LB3 LB2 LB1>;
    bindings = <&to DEFAULT_HM_ONE>;
    layers = <0 1 2 3>;
};

switch_hm_two_layer {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <RT1 RT2 RT3 RT4>;
    bindings = <&to DEFAULT_HM_TWO>;
    layers = <0 1 2 3>;
};

switch_hm_none_layer {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <RB1 RB2 RB3 RB4>;
    bindings = <&to DEFAULT_HM_NONE>;
    layers = <0 1 2 3>;
};

// What layer am I on?
combo_layer_zero {
    timeout-ms = <COMBO_TERM_LOW>;
    key-positions = <LT4 LM4 LB4>;
    bindings = <&layer_zero>;
    layers = <0>;
};

combo_layer_one {
    timeout-ms = <COMBO_TERM_LOW>;
    key-positions = <LT4 LM4 LB4>;
    bindings = <&layer_one>;
    layers = <1>;
};

combo_layer_two {
    timeout-ms = <COMBO_TERM_LOW>;
    key-positions = <LT4 LM4 LB4>;
    bindings = <&layer_two>;
    layers = <2>;
};

combo_layer_three {
    timeout-ms = <COMBO_TERM_LOW>;
    key-positions = <LT4 LM4 LB4>;
    bindings = <&layer_three>;
    layers = <3>;
};


// Device settings

combo_reset_left {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <LT0 LT1 LT2>;
    bindings = <&sys_reset>;
    layers = <0 1 2>;
};
    
combo_reset_right {
    timeout-ms = <COMBO_TERM_HIGH>; 
    key-positions = <RT0 RT1 RT2>;
    bindings = <&sys_reset>;
    layers = <0 1 2>;
};
    
combo_bootloader_left {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <LT0 LT1 LT2 LT3>;
    bindings = <&bootloader>;
    layers = <0 1 2>;
};

combo_bootloader_right {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <RT0 RT1 RT2 RT3>;
    bindings = <&bootloader>;
    layers = <0 1 2>;
};


// Tricks 

combo_new_sentence {
    timeout-ms = <COMBO_TERM_HIGH>;
    key-positions = <RB3 RB4>;
    bindings = <&new_sentence>;
    layers = <0 1 2>;
};


// modifiers

combo_esc_left {
    timeout-ms = <20>;
    key-positions = <LT0 LT1>;
    bindings = <&kp ESC>;
    layers = <0 1 2>;
};

combo_esc_right {
    timeout-ms = <20>;
    key-positions = <RT0 RT1>;
    bindings = <&double_esc>;
    layers = <0 1 2>;
};

combo_repeat_left {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <LM1 LM2>;
    bindings = <&repeat>;
    layers = <0 1 2>;
};

// deactivating this combo in order to try repeat combo here
// combo_tab_left {
//     timeout-ms = <COMBO_TERM_MEDIUM>;
//     key-positions = <LM1 LM2>;
//     bindings = <&kp TAB>;
//     layers = <0 1 2>;
// };

combo_tab_right {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RM1 RM2>;
    bindings = <&kp TAB>;
    layers = <0 1 2>;
};

// two different ways of achieving control backspace

combo_control_backspace_left {
    timeout-ms = <COMBO_TERM_LOWEST>;
    key-positions = <LM0 LM1>;
    bindings = <&kp LC(BSPC)>;
    layers = <0 1 2>;
};

combo_control_backspace_right {
    timeout-ms = <COMBO_TERM_LOWEST>;
    key-positions = <RM0 RM1>;
    bindings = <&macro_control_back>;
    layers = <0 1 2>;
};

combo_alt_tab_left {
    timeout-ms = <COMBO_TERM_LOWEST>;
    key-positions = <LT1 LT2>;
    bindings = <&kp LA(TAB)>;
    layers = <0 1 2>;
};

combo_alt_tab_right {
    timeout-ms = <COMBO_TERM_LOWEST>;
    key-positions = <RT1 RT2>;
    bindings = <&macro_alt_tab>;
    layers = <0 1 2>;
};

// symbols
combo_brace_left {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <LT3 LM3>;
    bindings = <&kp LBRC>;
    layers = <0 1 2>;
};

combo_paranthesis_left {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <LT2 LM2>;
    bindings = <&kp LPAR>;
    layers = <0 1 2>;
};

combo_bracket_left {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <LT1 LM1>;
    bindings = <&kp LBKT>;
    layers = <0 1 2>;
};

combo_brace_right {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT3 RM3>;
    bindings = <&kp RBRC>;
    layers = <0 1 2>;
};

combo_paranthesis_right {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT2 RM2>;
    bindings = <&kp RPAR>;
    layers = <0 1 2>;
};

combo_bracket_right {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT1 RM1>;
    bindings = <&kp RBKT>;
    layers = <0 1 2>;
};

combo_comma {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT2 RM2>;
    bindings = <&kp COMMA>;
    layers = <NUMBER>;
};

combo_period {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT3 RM3>;
    bindings = <&kp PERIOD>;
    layers = <NUMBER>;
};

combo_comma_next {
    timeout-ms = <COMBO_TERM_MEDIUM>;
    key-positions = <RT1 RM1>;
    bindings = <&kp PERIOD>;
    layers = <NUMBER>;
};

// keys
combo_repeat {
    timeout-ms = <COMBO_TERM_LOWEST>;
    key-positions = <LB0 LB1>;
    bindings = <&key_repeat>;
    layers = <0 1 2>;
};
